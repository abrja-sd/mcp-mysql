### Test MySQL MCP Server via HTTP
### Make sure the server is running: python server.py

# Variables
@baseUrl = http://localhost:8000
@authToken = Bearer my-secret-token

### 1. Test Server Health / Root Endpoint
GET {{baseUrl}}/ HTTP/1.1

### 2. Initialize SSE Connection (MCP Protocol)
GET {{baseUrl}}/sse HTTP/1.1
Authorization: {{authToken}}
Accept: text/event-stream

### 3. List Available Tools (MCP Protocol)
POST {{baseUrl}}/mcp HTTP/1.1
Authorization: {{authToken}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/list",
  "params": {}
}

### 4. Call Tool: list_tables
POST {{baseUrl}}/mcp HTTP/1.1
Authorization: {{authToken}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 2,
  "method": "tools/call",
  "params": {
    "name": "list_tables",
    "arguments": {}
  }
}

### 5. Call Tool: get_table_schema
POST {{baseUrl}}/mcp HTTP/1.1
Authorization: {{authToken}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 3,
  "method": "tools/call",
  "params": {
    "name": "get_table_schema",
    "arguments": {
      "table_name": "users"
    }
  }
}

### 6. Call Tool: run_query
POST {{baseUrl}}/mcp HTTP/1.1
Authorization: {{authToken}}
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 4,
  "method": "tools/call",
  "params": {
    "name": "run_query",
    "arguments": {
      "query": "SELECT * FROM users LIMIT 5"
    }
  }
}

### 7. Test without Authorization (should fail)
POST {{baseUrl}}/mcp HTTP/1.1
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 5,
  "method": "tools/list",
  "params": {}
}

### 8. Test with wrong Authorization (should fail)
POST {{baseUrl}}/mcp HTTP/1.1
Authorization: Bearer wrong-token
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 6,
  "method": "tools/list",
  "params": {}
}
